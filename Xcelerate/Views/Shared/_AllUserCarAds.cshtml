@model List<AdPreviewViewModel>

<link rel="stylesheet" href="~/css/Ad/UserAds.css" asp-append-version="true" />

@if (Model.Count > 0)
{
	<section class="card-holder">
		@foreach (var ad in Model)
		{
			<article class="car-card">
				<div class="image-holder">
					@{
						// Display the first image
						var firstImage = ad.ImageUrls.FirstOrDefault();
						if (firstImage != null)
						{
							<img src="~/Images/Ad/@firstImage" alt="First image of the car ad" />
						}
					}
				</div>
				<h2 class="article-title">@ad.Brand @ad.Model</h2>
				<div card-text>
					<ul>
						<li><strong>Price:</strong> @ad.Price$</li>
						<li><strong>Year:</strong> @ad.Year</li>
						<li><strong>Engine:</strong> @ad.Engine</li>
						<li><strong>Condition:</strong> @ad.Condition</li>
						<li><strong>Euro Standard:</strong> @ad.EuroStandard</li>
						<li><strong>Fuel Type:</strong> @ad.FuelType</li>
						<li><strong>Owner:</strong> @ad.FirstName @ad.LastName</li>
					</ul>
					<footer class="bottom-text">
						<i class="edit-delete-cancel-buttons">
							<a class="edit-button" asp-area="" asp-controller="Ad" asp-action="Edit" asp-route-carId="@ad.CarId">Edit</a>
							<form asp-area="" asp-controller="Ad" asp-action="Delete" asp-route-carId="@ad.CarId" method="post">
								<button type="submit" class="delete-button">Delete</button>
							</form>
							<form asp-area="" asp-controller="UserCars" asp-action="Cancel" asp-route-carId="@ad.CarId" asp-route-adId="@ad.AdId" method="post">
								<button type="submit" class="cancel-button">Cancel</button>
							</form>
						</i>
					</footer>
				</div>
			</article>
		}
	</section>
}
else
{
	<section class="card-holder-message">
		<article class="car-card-message">
			<h2 class="article-title-message"> </h2>
			<div card-text>
				<h2 class="message">You don't have any ads yet. Consider creating one!</h2>
				<footer class="bottom-text-message">
					<ul>
						<i class="create-message-button">
							<a asp-area="" asp-controller="Ad" asp-action="Create">CREATE</a>
						</i>
					</ul>
				</footer>
			</div>
		</article>
	</section>
}

@if (TempData["DeleteMessage"] != null && (bool)TempData["DeleteMessage"])
{
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
		Swal.fire({
			icon: 'success',
			title: 'Ad deleted!',
			text: 'You have succesfully deleted an ad!',
		});
	</script>
	@TempData.Remove("DeleteMessage")
	;
}

@if (TempData["AdCreatedSuccesfully"] != null && (bool)TempData["AdCreatedSuccesfully"])
{
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
		Swal.fire({
			icon: 'success',
			title: 'Ad created!',
			text: 'You have succesfully created an ad!',
		});
	</script>
	@TempData.Remove("AdCreatedSuccesfully")
	;
}

@if (TempData["ConfirmDelete"] != null && (bool)TempData["ConfirmDelete"])
{
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script>
		Swal.fire({
			title: 'Confirm Delete',
			text: 'Are you sure you want to delete this car ad?',
			icon: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#d33',
			cancelButtonColor: '#3085d6',
			confirmButtonText: 'Yes, delete it!'
		}).then((result) => {
			if (result.isConfirmed) {

				var form = document.createElement('form');
				form.method = 'post';
				form.action = '/Ad/DeleteConfirmed';

				var input = document.createElement('input');
				input.type = 'hidden';
				input.name = 'carId';
				input.value = '@TempData["CarIdToDelete"]';

				form.appendChild(input);

				// Append the form to the document body and submit it
				document.body.appendChild(form);
				form.submit();

		@TempData.Remove("ConfirmDelete")
		@TempData.Remove("CarIdToDelete")
					}
		});
	</script>
}


